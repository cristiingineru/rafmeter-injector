<html><head></head><body><script>var RAFMeter = function () {

  var displayNode,
      curentTime,
      previousTime = Date.now(),
      previousDisplayTime = 0,
      maxDurationCount = 20,
      durations = [],
      displayInterval = 500;


  var tick = function() {
    curentTime = Date.now();

    if (durations.length === maxDurationCount) {
      durations.shift();
    }
    durations.push(curentTime - previousTime);

    display(durations);

    previousTime = curentTime;
    requestAnimationFrame(tick);
  };


  var display = function(durations) {
    var duration = durations.reduce(sum, 0),
        meanDuration = duration / durations.length,
        fps = (1000 / meanDuration).toFixed(1),
        message = fps + ' fps',
        elapsedTimeSinceLastDisplay = curentTime - previousDisplayTime;
    if (!displayNode) {
      displayNode = tryCreateDisplayNode();
    }
    if (displayNode && (elapsedTimeSinceLastDisplay > displayInterval)) {
      displayNode.nodeValue = message;
      previousDisplayTime = curentTime;
    }
  };


  var sum = function(a, b) {
    return a + b;
  };


  var insertFirst = function(parent, newChild) {
    if (parent.firstChild) {
      parent.insertBefore(newChild, parent.firstChild);
    } else {
      parent.appendChild(newChild);
    }
  };


  var tryCreateDisplayNode = function() {
    var target = document.body, displayNode;
    if (target) {
        displayNode = document.createTextNode('x fps');

        var para = document.createElement('p');
        para.className = 'fpsMeter';
        para.appendChild(displayNode);

        insertFirst(target, para);
    }
    return displayNode;
  };


  requestAnimationFrame(tick);
}
window.rafMeter = new RAFMeter();</script>{
  "name": "rafmeter-injector",
  "version": "0.0.1",
  "description": "Injects instrumentation to measure the number of frames per seconds for a page (fps)",
  "main": "rafmeter-injector.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
  },
  "repository": {
    "type": "git",
    "url": "git+https://github.com/cristiingineru/rafmeter-injector.git"
  },
  "keywords": [
    "fps",
    "raf",
    "meter"
  ],
  "author": "Cristi Ingineru",
  "license": "MIT",
  "bugs": {
    "url": "https://github.com/cristiingineru/rafmeter-injector/issues"
  },
  "homepage": "https://github.com/cristiingineru/rafmeter-injector#readme",
  "dependencies": {
    "jsdom": "^9.11.0",
    "rafmeter": "^0.0.1"
  },
  "devDependencies": {
    "glob": "^7.1.1"
  }
}
</body></html>